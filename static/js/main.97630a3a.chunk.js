(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{140:function(e,t,a){},167:function(e,t){},170:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"registerUser",function(){return j}),a.d(n,"loginUser",function(){return y}),a.d(n,"setCurrentUser",function(){return U}),a.d(n,"logoutUser",function(){return w});var r={};a.r(r),a.d(r,"createShortUrl",function(){return K});var l=a(0),o=a.n(l),i=a(42),s=a.n(i),c=(a(74),a(10)),u=a(11),h=a(14),m=a(12),p=a(15),d=a(173),f=a(175),g=a(171),E=a(32),b=a.n(E),v=a(8),S=a.n(v),O=function(e){e?S.a.defaults.headers.common.Authorization=e:delete S.a.defaults.headers.common.Authorization},C="https://bitlyclonerefactory.herokuapp.com/",j=function(e){return function(t){S.a.post(C+"api/users/register",e).then(function(e){return console.log(e)}).then(function(e){t({type:"REGISTER_SUCCESS"})}).catch(function(e){t({type:"REGISTER_ERROR",err:e})})}},y=function(e){return function(t){S.a.post(C+"api/users/login",e).then(function(e){var a=e.data.token;localStorage.setItem("jwtToken",a),O(a);var n=b()(a);t(U(n))}).catch(function(e){t({type:"LOGIN_ERROR",err:e})})}},U=function(e){return{type:"LOGIN_SUCCESS",payload:e}},w=function(){return function(e){localStorage.removeItem("jwtToken"),O(!1),e(U({}))}},R=a(18),k=a(17),N=function(e){return void 0===e||null===e||"object"===typeof e&&0===Object.keys(e).length||"string"===typeof e&&0===e.trim().length},I={authError:null,isAuthenticated:!1,user:{},registerStatus:!1},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_ERROR":return console.log("login error"),Object(k.a)({},e,{authError:"Login failed"});case"LOGIN_SUCCESS":return console.log("login success"),Object(k.a)({},e,{authError:null,isAuthenticated:!N(t.payload),user:t.payload});case"REGISTER_SUCCESS":return console.log("register success"),Object(k.a)({},e,{authError:null,registerStatus:!0});case"REGISTER_ERROR":return Object(k.a)({},e,{authError:t.err.response.data});default:return e}},D={urlShort:""},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHORT_URL_SUCCESS":return console.log("success"),Object(k.a)({},e,{urlShort:t.res.data.shortUrl});case"SHORT_URL_ERROR":return console.log("short url error"),e;default:return e}},L=Object(R.c)({auth:_,shortUrl:A}),T=a(67),B=Object(R.e)(L,Object(R.d)(Object(R.a)(T.a))),G=a(2),x=a(139),M=a(7),H=a(172),P=Object(M.b)(function(e){return e},n)(function(e){var t=e.logoutUser;return o.a.createElement("div",null,o.a.createElement("ul",{className:"right"},o.a.createElement("li",null,o.a.createElement(H.a,{to:"/myurl"},"My Url")),o.a.createElement("li",null,o.a.createElement(H.a,{to:"/logout",onClick:t},"Log Out"))))}),Y=function(){return o.a.createElement("div",null,o.a.createElement("ul",{className:"right"},o.a.createElement("li",null,o.a.createElement(H.a,{to:"/register"},"Register")),o.a.createElement("li",null,o.a.createElement(H.a,{to:"/login"},"Login"))))},z=Object(M.b)(function(e){return e},n)(function(e){var t=!0===e.auth.isAuthenticated?o.a.createElement(P,{props:e}):o.a.createElement(Y,null);return o.a.createElement(G.Navbar,{className:"green"},o.a.createElement("div",{className:"container"},o.a.createElement(x.a,{to:"/",className:"brand-logo"},"URL Shorter"),t))}),W=a(13),F=a(174),J=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",email:"",password:"",password2:""},a.handleChange=function(e){a.setState(Object(W.a)({},e.target.id,e.target.value))},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.registerUser(this.state)}},{key:"render",value:function(){if(this.props.auth.registerStatus)return o.a.createElement(F.a,{to:"/login"});var e="",t="",a="",n="";return null!=this.props.auth.authError&&(e=this.props.auth.authError.name||"",t=this.props.auth.authError.email||"",n=this.props.auth.authError.password||"",a=this.props.auth.authError.password2||""),o.a.createElement("form",{onSubmit:this.handleSubmit.bind(this),className:"center container"},o.a.createElement(G.Row,null,o.a.createElement(G.Input,{s:12,label:"Name",id:"name",error:e,onChange:this.handleChange}),o.a.createElement(G.Input,{s:12,type:"email",label:"Email",id:"email",error:t,onChange:this.handleChange}),o.a.createElement(G.Input,{s:12,type:"password",label:"Password",id:"password",error:n,onChange:this.handleChange}),o.a.createElement(G.Input,{s:12,type:"password",label:"Confirm Password",id:"password2",error:a,onChange:this.handleChange})),o.a.createElement(G.Button,{type:"submit",value:"Submit"},"Register"))}}]),t}(l.Component),V=Object(M.b)(function(e){return e},n)(J),$=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:""},a.handleChange=function(e){a.setState(Object(W.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.props.loginUser(a.state)},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.props.auth.isAuthenticated?o.a.createElement(F.a,{to:"/"}):o.a.createElement("form",{onSubmit:this.handleSubmit.bind(this),className:"center container"},o.a.createElement(G.Row,null,o.a.createElement(G.Input,{name:"email",s:12,type:"email",label:"Email",id:"email",onChange:this.handleChange}),o.a.createElement(G.Input,{name:"password",s:12,type:"password",label:"Password",id:"password",onChange:this.handleChange})),o.a.createElement(G.Button,{type:"submit",value:"Submit"},"Login"))}}]),t}(l.Component),q=Object(M.b)(function(e){return e},n)($),K=(a(140),function(e){return function(t){S.a.post(C+"api/shorters",e).then(function(e){console.log(e),t({type:"SHORT_URL_SUCCESS",res:e})}).catch(function(e){t({type:"SHORT_URL_ERROR",err:e})})}}),Q=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={originalUrl:""},a.handleChange=function(e){a.setState(Object(W.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.props.createShortUrl(a.state)},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.shortUrl.urlShort||"";return o.a.createElement("div",{className:"App App-header"},o.a.createElement(G.Modal,{header:"Shorting URL",trigger:o.a.createElement(G.Button,null,"Create")},o.a.createElement("form",{onSubmit:this.handleSubmit.bind(this),className:"center container"},o.a.createElement(G.Row,null,o.a.createElement(G.Input,{s:12,label:"Paste your url",id:"originalUrl",onChange:this.handleChange})),o.a.createElement("p",null,"Your short url :"," ",this.props.auth.isAuthenticated?o.a.createElement("a",{href:e},e):"Your login session outdated, You must login first"),o.a.createElement(G.Button,{type:"submit",value:"Submit"},"Create"))))}}]),t}(l.Component),X=Object(M.b)(function(e){return e},r)(Q),Z=Object(M.b)(function(e){return e},n)(function(e){return o.a.createElement("div",{className:"blue lighten-5 "},o.a.createElement(G.Row,{className:"container"},o.a.createElement("img",{src:e.auth.user.avatar,alt:"profile",className:"circle"}),o.a.createElement("h4",null,e.auth.user.name)))}),ee=a(68),te=a.n(ee),ae=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={title:a.props.props.title,urlCode:a.props.props.urlCode,originalUrl:a.props.props.originalUrl,shortUrl:a.props.props.shortUrl,response:""},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"handleChange",value:function(e){this.setState(Object(W.a)({},e.target.id,e.target.value))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),S.a.put(C+"api/shorters/update/"+this.props.props._id,Object(k.a)({},this.state,{shortUrl:C+this.state.urlCode})).then(function(e){t.setState({response:e.status})}).catch(function(e){console.log(e),t.setState({response:404})})}},{key:"render",value:function(){var e="";return 200===this.state.response&&(e=o.a.createElement("p",{className:"green-text"},"Success")),404===this.state.response&&(e=o.a.createElement("p",{className:"red-text"},"Failed, URL already axist")),o.a.createElement("form",{onSubmit:this.handleSubmit.bind(this),className:"center container"},o.a.createElement(G.Row,null,o.a.createElement(G.Input,{s:12,defaultValue:this.props.props.title,label:"title",id:"title",onChange:this.handleChange.bind(this)}),o.a.createElement(G.Input,{s:12,defaultValue:this.props.props.urlCode,label:C,id:"urlCode",onChange:this.handleChange.bind(this)})),o.a.createElement("div",null,e),o.a.createElement(G.Button,{type:"submit",value:"Submit"},"Edit"))}}]),t}(l.Component),ne=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).formatDate=function(e){var t=new Date(e);return"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate())},a.state={listUrl:[],from:"2001-01-01",to:"9999-12-31"},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this;S.a.get(C+"api/shorters").then(function(t){e.setState({listUrl:t.data})}).catch(function(e){return console.log(e)});var t=te()(C);t.on("shorter",function(t){var a=e.state.listUrl.map(function(e){return e.shortUrl===t.shortUrl&&(e.totalClicks=t.totalClicks),e});e.setState({listUrl:a})}),t.on("shorterUpdate",function(t){var a=e.state.listUrl.map(function(e){return e._id===t._id&&(e=t),e});e.setState({listUrl:a})})}},{key:"handleChange",value:function(e){this.setState(Object(W.a)({},e.target.id,this.formatDate(e.target.value)))}},{key:"handleSubmit",value:function(e){e.preventDefault()}},{key:"handlDelete",value:function(e){var t=this;S()(C+"api/shorters/delete/"+e,{method:"DELETE"}).then(function(a){t.setState(function(t){return{listUrl:t.listUrl.filter(function(t){return t._id!==e})}})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this,t=this.state,a=t.from,n=t.listUrl,r=t.to,l=n.filter(function(t){return e.formatDate(new Date(t.createdAt))>=a&&e.formatDate(new Date(t.createdAt))<=r}).map(function(t){return o.a.createElement(G.Row,{key:t._id,className:"z-depth-1"},o.a.createElement("div",{className:"container"},o.a.createElement(G.Col,{s:12},"Created At : ",t.createdAt),o.a.createElement(G.Col,{s:12},o.a.createElement("h4",null,t.title||"No Title")),o.a.createElement(G.Col,{s:12},"Original Url : ",o.a.createElement("a",{href:t.originalUrl},t.originalUrl)),o.a.createElement(G.Col,{s:12},"Short Url :"," ",o.a.createElement("a",{href:t.shortUrl,id:t.shortUrl},t.shortUrl)),o.a.createElement(G.Col,{s:12},"Total Clicks : ",o.a.createElement("h4",null,t.totalClicks)),o.a.createElement(G.Col,{s:12},o.a.createElement(G.Button,{s:2,className:"red ",onClick:e.handlDelete.bind(e,t._id)},"Delete"),o.a.createElement(G.Modal,{header:"Shorting URL",trigger:o.a.createElement(G.Button,null,"Edit")},o.a.createElement(ae,{props:t})))))});return o.a.createElement("div",{className:"center"},o.a.createElement(Z,null),o.a.createElement("form",{onSubmit:this.handleSubmit.bind(this),className:"container"},o.a.createElement(G.Row,null,o.a.createElement(G.Input,{s:6,type:"date",className:"datepicker",label:"from",id:"from",onChange:this.handleChange.bind(this)}),o.a.createElement(G.Input,{s:6,type:"date",className:"datepicker",label:"to",id:"to",onChange:this.handleChange.bind(this)}))),0!==l.length?l:"Data not found")}}]),t}(l.Component);if(localStorage.jwtToken){O(localStorage.jwtToken);var re=b()(localStorage.jwtToken);B.dispatch(U(re));var le=Date.now()/1e3;re.exp<le&&(B.dispatch(w()),window.location.href="/login")}var oe=function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return console.log(C),o.a.createElement(d.a,null,o.a.createElement("div",null,o.a.createElement(z,null),o.a.createElement(f.a,null,o.a.createElement(g.a,{exact:!0,path:"/",component:X}),o.a.createElement(g.a,{path:"/register",component:V}),o.a.createElement(g.a,{path:"/login",component:q}),o.a.createElement(g.a,{path:"/myurl",component:ne}))))}}]),t}(l.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(M.a,{store:B},o.a.createElement(oe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},69:function(e,t,a){e.exports=a(170)},74:function(e,t,a){}},[[69,2,1]]]);
//# sourceMappingURL=main.97630a3a.chunk.js.map